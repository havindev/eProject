# XAMPP Virtual Hosts Configuration for Green Groves
# Place this in: C:\xampp\apache\conf\extra\httpd-vhosts.conf

# Virtual Host for Frontend (Port 80)
<VirtualHost *:80>
    ServerName 103.252.93.249
    DocumentRoot "C:/xampp/htdocs/frontend"
    
    # CORS Headers for Frontend
    Header always set Access-Control-Allow-Origin "*"
    Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
    Header always set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With, Accept, Origin"
    Header always set Access-Control-Allow-Credentials "true"
    
    # Handle OPTIONS requests
    RewriteEngine On
    RewriteCond %{REQUEST_METHOD} OPTIONS
    RewriteRule ^(.*)$ $1 [R=200,L]
    
    # Directory settings
    <Directory "C:/xampp/htdocs/frontend">
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
        
        # SPA routing - redirect all to index.html
        RewriteEngine On
        RewriteBase /
        RewriteRule ^index\.html$ - [L]
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule . /index.html [L]
    </Directory>
    
    # Error and access logs
    ErrorLog "logs/frontend-error.log"
    CustomLog "logs/frontend-access.log" combined
</VirtualHost>

# Virtual Host for Backend API (Port 8080)
<VirtualHost *:8080>
    ServerName 103.252.93.249:8080
    DocumentRoot "C:/xampp/htdocs/backend/public"
    
    # CORS Headers for Backend
    Header always set Access-Control-Allow-Origin "*"
    Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS, PATCH"
    Header always set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With, Accept, Origin, X-CSRF-TOKEN"
    Header always set Access-Control-Allow-Credentials "true"
    Header always set Access-Control-Expose-Headers "Content-Length, X-JSON"
    
    # Handle OPTIONS requests
    RewriteEngine On
    RewriteCond %{REQUEST_METHOD} OPTIONS
    RewriteRule ^(.*)$ $1 [R=200,L]
    
    # Laravel routing
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php [QSA,L]
    
    # Directory settings
    <Directory "C:/xampp/htdocs/backend/public">
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
        
        # PHP settings
        <Files "*.php">
            SetHandler application/x-httpd-php
        </Files>
    </Directory>
    
    # Error and access logs
    ErrorLog "logs/backend-error.log"
    CustomLog "logs/backend-access.log" combined
</VirtualHost>

# Default Virtual Host (fallback)
<VirtualHost *:80>
    ServerName 103.252.93.249
    DocumentRoot "C:/xampp/htdocs"
    
    <Directory "C:/xampp/htdocs">
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
</VirtualHost>
